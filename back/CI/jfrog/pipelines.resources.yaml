resources:

# gradle PIPELINE
  - name: src_code_k8s_backapp_gradle
    type: GitRepo
    configuration:
      files:
        include: ^back\/.+
        exclude: ^back\/CI\/.+
      gitProvider: yann_github
      path: cyan21/k8s-app
      branches:
        include: jfrog-ode

  # Build info for the published gradle App
  - name: bi_k8s_backapp
    type: BuildInfo
    configuration:
      sourceArtifactory: artifactory_eu
      buildName: k8s_backapp_gradle
      buildNumber: ${run_number}
  
  - name: bi_k8s_backapp_gradle_promoted_staging
    type: BuildInfo
    configuration:
      sourceArtifactory: artifactory_eu
      buildName: k8s_backapp_gradle
      buildNumber: ${run_number}
  
  - name: pb_k8s_backapp_gradle
    type: PropertyBag
    configuration:
      biNumber: XXX

# DOCKER PIPELINE
  - name: src_dockerfile_k8s_backapp_gradle
    type: GitRepo
    configuration:
      files:
        include: ^back\/CI\/Docker\/.+
      gitProvider: yann_github
      path: cyan21/k8s-app
      branches:
        include: jfrog-ode

  - name: k8s_backapp_exec
    type: FileSpec
    configuration:
      sourceArtifactory: artifactory_eu
      pattern:  ${grdlPromoteRepo}/*/webservice-*.war
      # pattern: 'app-gradle-rc-local/*/webservice-*.war'
      #pattern: 'app-gradle-rc-local/org/jfrog/example/gradle/webservice/1.1.2/webservice-1.1.2.war'
      buildName: k8s_backapp_gradle_docker
      buildNumber: ${run_number}
      target: war/webservice.war
      flat: true

  - name: bi_k8s_backapp_gradle_docker
    type: BuildInfo
    configuration:
      sourceArtifactory: artifactory_eu
      buildName: k8s_backapp_gradle_docker
      buildNumber: ${run_number}

  # - name: build_info_docker_backapp_scanned
  #   type: BuildInfo
  #   configuration:
  #     sourceArtifactory: artifactory
  #     buildName: back_app-docker
  #     buildNumber: '${run_number}'

  - name: bi_k8s_backapp_gradle_docker_promoted_staging
    type: BuildInfo
    configuration:
      sourceArtifactory: artifactory_eu
      buildName: k8s_backapp_gradle_docker
      buildNumber: ${run_number}