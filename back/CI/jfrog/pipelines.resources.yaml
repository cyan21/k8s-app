resources:

# gradle PIPELINE
  - name: src_code_backapp
    type: GitRepo
    configuration:
      files:
        include: ^back\/.+
        exclude: ^back\/CI\/.+
      gitProvider: hza_github
      path: HamzaZFrog/k8s-app
      branches:
        include: master

# DOCKER PIPELINE
  - name: src_dockerfile_backapp
    type: GitRepo
    configuration:
      files:
        include: ^back\/CI\/Docker\/.+
      path: HamzaZFrog/k8s-app
      branches:
        include: master
      gitProvider: hza_github

  # Build info for the published gradle App
  - name: backappBuildInfo
    type: BuildInfo
    configuration:
      sourceArtifactory: artifactory_eu
      buildName: backapp_gradle_pipeline
      buildNumber: ${run_number}

  - name: backappBuildInfo_scanned
    type: BuildInfo
    configuration:
      sourceArtifactory: artifactory_eu
      buildName: backapp_gradle_pipeline
      buildNumber: '${run_number}'
  
  - name: build_info_backapp_promoted
    type: BuildInfo
    configuration:
      sourceArtifactory: artifactory_eu
      buildName: backapp_gradle_pipeline
      buildNumber: '${run_number}'

  - name: backapp_exec
    type: FileSpec
    configuration:
      sourceArtifactory: artifactory_eu
      pattern: app-gradle-rc-local/back/**/back**
      buildName: ${triggerBuildInfoName}
      buildNumber: ${triggerBuildInfoNumber}
      flat: true
#      pattern: app-generic/backend
#      aql: '{"name":"backend","@build.name":"backapp_go_pipeline","@build.number":"43"}'
#      aql: "({\"name\":\"backend\"})"

  - name: build_info_docker_backapp
    type: BuildInfo
    configuration:
      sourceArtifactory: artifactory_eu
      buildName: backapp-docker
      buildNumber: '${run_number}'

  - name: build_info_docker_backapp_scanned
    type: BuildInfo
    configuration:
      sourceArtifactory: artifactory_eu
      buildName: backapp-docker
      buildNumber: '${run_number}'

  - name: build_info_docker_backapp_promoted
    type: BuildInfo
    configuration:
      sourceArtifactory: artifactory_eu
      buildName: backapp-docker
      buildNumber: '${run_number}'
