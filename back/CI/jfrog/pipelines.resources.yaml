resources:
# GO PIPELINE
  - name: src_code_backapp
    type: GitRepo
    configuration:
      path: cyan21/k8s-app
      branches:
        include: master
      files:
        exclude: ^back\/CI\/Docker\/.+
      gitProvider: yann_github

# DOCKER PIPELINE
  - name: src_dockerfile_backapp
    type: GitRepo
    configuration:
      path: cyan21/k8s-app
      branches:
        include: master
      files:
        include: ^back\/CI\/Docker\/.+
      gitProvider: yann_github

  # HELM PIPELINE
  # - name: src_helm_chart_app
  #   type: GitRepo
  #   configuration:
  #     path: cyan21/k8s-helm
  #     branches:
  #       include: master
  #     gitProvider: yann_github

  # Build info for the published Go app
  - name: build_info_backapp
    type: BuildInfo
    configuration:
      sourceArtifactory: artifactory_eu
      buildName: backapp-go
      buildNumber: 1

  - name: build_info_backapp_scanned
    type: BuildInfo
    configuration:
      sourceArtifactory: artifactory_eu
      buildName: backapp-go
      buildNumber: 1
  
  - name: build_info_backapp_promoted
    type: BuildInfo
    configuration:
      sourceArtifactory: artifactory_eu
      buildName: backapp-go
      buildNumber: 1

# DOCKER PIPELINE 
  - name: backapp_exec
    type: FileSpec
    configuration:
      sourceArtifactory: artifactory_eu
      pattern: app-generic/backend

  - name: build_info_docker_backapp
    type: BuildInfo
    configuration:
      sourceArtifactory: artifactory_eu
      buildName: backapp-docker
      buildNumber: 1

  - name: build_info_docker_backapp_scanned
    type: BuildInfo
    configuration:
      sourceArtifactory: artifactory_eu
      buildName: backapp-docker
      buildNumber: 1

  - name: build_info_docker_backapp_promoted
    type: BuildInfo
    configuration:
      sourceArtifactory: artifactory_eu
      buildName: backapp-docker
      buildNumber: 1

# DEPLOY pipeline
  - name: app_helm_chart
    type: HelmChart
    configuration:
      sourceArtifactory: artifactory_eu
      repository: app-helm
      chart: my-app
      version: 0.1.0
